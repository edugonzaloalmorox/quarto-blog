<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edu Gonzalo-Almorox">
<meta name="dcterms.date" content="2023-06-09">

<title>Unknown data pleasures - Setting up an AWS environment on Mac</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Unknown data pleasures</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target=""><i class="bi bi-person-circle" role="img" aria-label="website">
</i> 
 <span class="menu-text">About me‚Ä¶</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/edugonzaloalmorox" rel="" target=""><i class="bi bi-github" role="img" aria-label="github">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/EdudinGonzalo" rel="" target=""><i class="bi bi-twitter" role="img" aria-label="twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/eduardo-gonzalo-almorox-phd-5b8b4955/" rel="" target=""><i class="bi bi-linkedin" role="img" aria-label="linkedin">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Setting up an AWS environment on Mac</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">AWS</div>
                <div class="quarto-category">MLOps</div>
                <div class="quarto-category">EC2</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Edu Gonzalo-Almorox </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 9, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#launch-an-instance-on-aws" id="toc-launch-an-instance-on-aws" class="nav-link active" data-scroll-target="#launch-an-instance-on-aws">Launch an instance on AWS</a></li>
  <li><a href="#connection-of-ec2-to-local-machine" id="toc-connection-of-ec2-to-local-machine" class="nav-link" data-scroll-target="#connection-of-ec2-to-local-machine">Connection of EC2 to local machine</a>
  <ul>
  <li><a href="#locate-the-key-pair-file-in-your-machine" id="toc-locate-the-key-pair-file-in-your-machine" class="nav-link" data-scroll-target="#locate-the-key-pair-file-in-your-machine">Locate the key pair file in your machine</a></li>
  <li><a href="#modify-the-host-alias" id="toc-modify-the-host-alias" class="nav-link" data-scroll-target="#modify-the-host-alias">Modify the host alias</a></li>
  <li><a href="#link-the-key-pair-to-aws-instance" id="toc-link-the-key-pair-to-aws-instance" class="nav-link" data-scroll-target="#link-the-key-pair-to-aws-instance">Link the key pair to AWS instance</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>If you want to create a MLOps project, it is likely that you will interact with services offered by a cloud provider. For doing that you will likely require to link your local machine to any of the instances offered by the cloud provider. In this post, we will see how to set up the environment for a Mac machine to work with an EC2 instance on AWS.&nbsp;</p>
<section id="launch-an-instance-on-aws" class="level3">
<h3 class="anchored" data-anchor-id="launch-an-instance-on-aws">Launch an instance on AWS</h3>
<p>An instance is a server that provides computing services and that is managed by the cloud provider. AWS offers different types of instances depending on the activity to be performed (computation, memory intensive or graphic intensive).</p>
<p>The most common instances for general use are the Elastic Compute Cloud - <em>EC2</em> - which offer a <a href="https://aws.amazon.com/ec2/instance-types/?trk=e011bdeb-247d-4bc7-92eb-1b11f87bfc8a&amp;sc_channel=ps&amp;ef_id=CjwKCAjw-IWkBhBTEiwA2exyO1pn8lCc9XWbS9Jujs1qGVQdBcNcmaCJ2CPeIfz5OMPBTyODbXKkjhoCOTkQAvD_BwE:G:s&amp;s_kwcid=AL!4422!3!536392708261!e!!g!!aws%20ec2%20instance%20types!12195830327!119606867160">range of combinations</a> in terms of CPU, storage and networking capacity. For choosing the right instance there are three main points to consider:</p>
<ul>
<li><p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html">Define the operating system for the Amazon Machine Image</a>: Linux, macOS, Ubuntu, Windows‚Ä¶</p></li>
<li><p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html">Define the instance type</a> : nano, mini, large‚Ä¶</p></li>
<li><p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">Define the key pair</a> : This is important for connecting your local machine to the instance since these are the security credentials to prove the identity when connecting to an EC2 instance. There are two key types available: <code>.pem</code> and <code>.ppk</code></p></li>
</ul>
</section>
<section id="connection-of-ec2-to-local-machine" class="level3">
<h3 class="anchored" data-anchor-id="connection-of-ec2-to-local-machine">Connection of EC2 to local machine</h3>
<p>A convenient type of instance for MLOps can be a <code>t2.xlarge</code> Amazon Linux 2023. I provides a fair value for the computation power acquired. Yet, the choice of the type of instance will depend on the nature of the project and the budget available.</p>
<section id="locate-the-key-pair-file-in-your-machine" class="level4">
<h4 class="anchored" data-anchor-id="locate-the-key-pair-file-in-your-machine">Locate the key pair file in your machine</h4>
<p>Once the instance is launched on AWS management console, the way to connect it to your local machine is by locating the <code>.pem</code> key pair created when launching the instance, in the .ssh (hidden)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> folder of the local machine and running the following command on the terminal</p>
<p><code>ssh -i ~/.ssh/&lt;name of pem_file.pem&gt; ec2-user@&lt;public IPv4 address&gt;</code></p>
<p><img src="directory.png" class="img-fluid"></p>
<p>This code essentially connects the local machine to the AWS instance. Note that the user name associated with Mac is not <code>@ubuntu</code> but <code>ec2-user</code> instead.</p>
</section>
<section id="modify-the-host-alias" class="level4">
<h4 class="anchored" data-anchor-id="modify-the-host-alias">Modify the host alias</h4>
<p>To avoid adding the public IPv4 address every time the instance is launched, we can modify the config file in the <code>.ssh</code> folder and provide an alias (for example <code>mlops-zoomcamp</code>) to the Host. The aim for that is to avoid typing such a long instruction and connect it using the alias instead.</p>
<p><img src="config.png" class="img-fluid" width="722"></p>
<p>The <code>config</code> file is composed of the following Linux parameters.</p>
<ul>
<li><p><strong>Host:</strong> Is the alias you want to use to launch your instance</p></li>
<li><p><strong>HostName:</strong> Is the Public IPv4 address of your instance.</p>
<blockquote class="blockquote">
<p>‚ö†Ô∏è Every time the instance is launched this parameter changes and therefore it also needs to be changed in the config file ‚ö†Ô∏è</p>
<p><img src="IPv4.png" class="img-fluid"></p>
</blockquote></li>
<li><p><strong>IdentityFile:</strong> File with the key</p></li>
<li><p><strong>StrictHostKeyChecking:</strong> It specifies if there are host keys checked</p></li>
</ul>
</section>
<section id="link-the-key-pair-to-aws-instance" class="level4">
<h4 class="anchored" data-anchor-id="link-the-key-pair-to-aws-instance">Link the key pair to AWS instance</h4>
<p>To connect to the instance you just need to type the following command</p>
<p><code>ssh &lt;host_alias&gt;</code></p>
<p>The first time you try to connect you may receive the following message</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ec2_install.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>In that case you need to change the permissions of the public key using <code>chmod 0400 &lt;location_pem_file&gt;</code> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ec2_install_2.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Voil√† ü•≥ ‚Ä¶. now your machine is connected.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>To view hidden folders on mac press Command + Shift + Dot<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p><code>chmod</code> Is a Linux command that sets the permissions for file‚Äôs access. <code>0400</code> enables the user to read but can‚Äôt write nor execute.<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<!-- plausible -->
<script async="" defer="" data-domain="https://edugonalmo.netlify.app" src="https://plausible.io/js/plausible.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="edugonzaloalmorox/quarto-blog" data-repo-id="R_kgDOJskfmQ" data-category="General" data-category-id="DIC_kwDOJskfmc4CXFNh" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>